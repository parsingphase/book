{% macro chapterStatusIcons(chapter) %}
    {% if not chapter.active %}<span class="glyphicon glyphicon-eye-close"></span>{% endif %}
    {#{% if not post.inPast %}<span class="glyphicon glyphicon-calendar"></span>{% endif %}#}
{% endmacro %}

{% macro indexPagePost(chapter) %}
    {% import _self as book %}
    <div class="panel panel-default">
        <div class="panel-heading">
            <a href="{{ path('book.readChapter',{chapterId: chapter.id, slug: chapter.slug}) }}">{{ book.chapterStatusIcons(chapter) }}
                <span class="chapterTitle">{{ chapter.chapterNumber }}) {{ chapter.subject }}</span></a>
        </div>
        <div class="panel-body">
            {{ chapter.body|striptags|slice(0,600) }}...
        </div>
        <div class="panel-footer">
            <div class="pull-right">
                <a href="{{ path('book.readChapter',{chapterId: chapter.id, slug: chapter.slug}) }}">Permalink</a>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
{% endmacro %}

{% macro singlePagePost(chapter) %}
    {% import _self as book %}

    <div class="singlePageBlogPost">
        <div class="pull-right">
            {#{% if is_granted('ROLE_ADMIN') %}<a class="btn btn-default"#}
            {#href="{{ path('book.editPost',{uid: post.id, slug: post.slug}) }}"><span#}
            {#class="glyphicon glyphicon-pencil"></span> Edit</a> {% endif %}#}
        </div>

        <h1>{{ book.chapterStatusIcons(chapter) }}
            <span class="chapterTitle">{{ chapter.subject }}</span></h1>

        <div class="well chapterbody">
            {{ chapter.body|raw|nl2br }}
            <div class="pull-right attribution">
                {#Posted by {{ post.creator.name }}, {{ post.time|date('Y-m-d H:i') }}#}
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
{% endmacro %}

{% macro tableOfContents(chapters,currentChapter) %}
    <div class="well book-toc">
        <h3>Contents</h3>
        <ul>
            <li><a href="{{ path('book.index') }}">Index</a></li>
            {% for tocChapter in chapters %}
                {% if tocChapter.chapterNumber == currentChapter %}
                    <li>Â» {{ tocChapter.chapterNumber }} {{ tocChapter.subject }}</li>
                {% else %}
                    <li>
                        <a href="{{ path('book.readChapter',{chapterId: tocChapter.id, slug: tocChapter.slug}) }}">{{ tocChapter.chapterNumber }} {{ tocChapter.subject }}</a>
                    </li>
                {% endif %}
            {% endfor %}
        </ul>
    </div>
{% endmacro %}


{% macro prevNextChapter(chapters,currentChapter) %}
    <div class="bookNav well">
        {% set prevChapterNumber = currentChapter-1 %}
        {% set nextChapterNumber = currentChapter+1 %}
        {% set prevChapter = null %}
        {% set nextChapter = null %}

        {% for tocChapter in chapters %}
            {% if tocChapter.chapterNumber == prevChapterNumber %}
                {% set prevChapter = tocChapter %}
            {% elseif tocChapter.chapterNumber == nextChapterNumber %}
                {% set nextChapter = tocChapter %}
            {% endif %}
        {% endfor %}

        <div class="prevChapter col-sm-5 text-left">{% if prevChapter %}
                Back: <a
                        href="{{ path('book.readChapter',{chapterId: prevChapter.id, slug: prevChapter.slug}) }}">{{ prevChapter.subject }}</a>
            {% endif %}</div>
        <div class="toIndex col-sm-2 text-center">Up: <a href="{{ path('book.index') }}">Index</a></div>
        <div class="nextChapter col-sm-5 text-right">{% if nextChapter %}
                Next: <a
                        href="{{ path('book.readChapter',{chapterId: nextChapter.id, slug: nextChapter.slug}) }}">{{ nextChapter.subject }}</a>
            {% endif %}</div>
        <div class="clearfix"></div>
    </div>
{% endmacro %}
